{"version":3,"sources":["common-utilities.es6.js"],"names":["getTypeString","obj","Object","prototype","toString","call","clone","arg","JSON","parse","stringify","isDefined","copySpecifiedObjectProperties","propertyList","src","dst","forEach","property","getOwnProperties","getOwnPropertyNames","generateRange","start","end","result","push","generateFirstNNaturalNumbers","n","replicateString","str","reduce","accumulator","zeroPadNumber","minLength","slice","getDateTimeString","date","typeStringOfParam","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","insertNumberIntoArray","array","i","findIndex","m","length","splice","insertionSort","removeDuplicatesFromArray","x","y","includes","safeJsonParse","dflt","e","uuid","s","Math","random","substring","substr","floor","isArray","isArrayOfNumbers","every","element","isFunction","sum","mean","median","sortedArray","sort","histogram","mode","hist","keys","count","getAllSubsetsHelper","subsetInProgress","pop","getAllSubsets","sortSubsets","fnSubsetComparator","s1","s2","lengthDiff","elementDiff","isSubset","set1","set2","fnElementsAreEqual","element1","find","element2","areSetsEqual","a","b"],"mappings":"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","sourcesContent":["/**\r\n * thaw-common-utilities.js\r\n *\r\n * @copyright 2018 Tom Weatherhead <null@2hrd4u.org> (https://httpbin.org/status/418)\r\n * @license MIT\r\n * @version 0.0.3\r\n */\r\n// @tom-weatherhead/common-utilities.js/src/main.js\n\n'use strict';\n\n// **** Type Utilities ****\n\nexport function getTypeString (obj) {\n\treturn Object.prototype.toString.call(obj);\n}\n\n// **** Object utilities ****\n\n/*\n// From A. Levy's answer at https://stackoverflow.com/questions/728360/how-do-i-correctly-clone-a-javascript-object\n\nWhen I had to implement general deep copying I ended up compromising by assuming that I would only need to copy\na plain Object, Array, Date, String, Number, or Boolean. The last 3 types are immutable, so I could perform a shallow copy\nand not worry about it changing. I further assumed that any elements contained in Object or Array would also be one of the 6 simple types\nin that list. This can be accomplished with code like the following:\n\nfunction clone(obj) {\n    var copy;\n\n    // Handle the 3 simple types, and null or undefined\n    if (null == obj || \"object\" != typeof obj) return obj;\n\n    // Handle Date\n    if (obj instanceof Date) {\n        copy = new Date();\n        copy.setTime(obj.getTime());\n        return copy;\n    }\n\n    // Handle Array\n    if (obj instanceof Array) {\n        copy = [];\n        for (var i = 0, len = obj.length; i < len; i++) {\n            copy[i] = clone(obj[i]);\n        }\n        return copy;\n    }\n\n    // Handle Object\n    if (obj instanceof Object) {\n        copy = {};\n        for (var attr in obj) {\n            if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n        }\n        return copy;\n    }\n\n    throw new Error(\"Unable to copy obj! Its type isn't supported.\");\n}\n\nThe above function will work adequately for the 6 simple types I mentioned, as long as the data in the objects and arrays form a tree structure.\nThat is, there isn't more than one reference to the same data in the object.\n*/\n\nexport function clone (arg) {\n\t// For an in-depth discussion of object copying, see https://scotch.io/bar-talk/copying-objects-in-javascript\n\n\t// **** Warning: JSON.parse(JSON.stringify(arg)) will fail for circular objects.\n\t// ? Do we need isCircular(obj) ?\n\treturn JSON.parse(JSON.stringify(arg));\n\n\t// From avoidwork/haro/src/utility.js :\n\t// return JSON.parse(JSON.stringify(arg, null, 0)); // TODO: What are the second and third parameters to stringify() ?\n}\n\nexport function isDefined (obj) {\n\treturn typeof obj !== 'undefined';\n}\n\nexport function copySpecifiedObjectProperties (propertyList, src, dst = {}) {\n\n\tpropertyList.forEach(property => {\n\n\t\t// if (typeof src[property] !== 'undefined') {\n\t\tif (isDefined(src[property])) {\n\t\t\tdst[property] = src[property];\n\t\t}\n\t});\n\n\treturn dst;\n}\n\nexport function getOwnProperties (obj = {}) {\n\t/*\n\t// Version 1\n\t// See https://stackoverflow.com/questions/208016/how-to-list-the-properties-of-a-javascript-object\n\tlet result = [];\n\n\tfor (var key in obj) {\n\t\tif (obj.hasOwnProperty(key)) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\n\treturn result;\n\t*/\n\n\t// Version 2\n\t// See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames\n\treturn Object.getOwnPropertyNames(obj);\n}\n\n// **** Numeric utilities ****\n\nexport function generateRange (start, end) {\n\tlet result = [];\n\n\twhile (start <= end) {\n\t\tresult.push(start);\n\t\tstart++;\n\t}\n\n\treturn result;\n}\n\nexport function generateFirstNNaturalNumbers (n) {\n\treturn generateRange(1, n);\n}\n\nexport function replicateString (str, n) {\n\treturn generateFirstNNaturalNumbers(n)\n\t\t.reduce(\n\t\t\t// (accumulator, i) => accumulator + str,\n\t\t\taccumulator => accumulator + str,\n\t\t\t''\n\t\t);\n}\n\nexport function zeroPadNumber (n, minLength) {\n\treturn (replicateString('0', minLength) + n).slice(-minLength);\n}\n\n// **** Date Utilities ****\n\nexport function getDateTimeString (date) {\n\tconst typeStringOfParam = getTypeString(date);\n\n\t// console.log('getDateTimeString() : Type of date parameter is', typeStringOfParam);\n\n\tif (!date || typeStringOfParam !== '[object Date]') {\n\t\t// console.log('getDateTimeString() : Setting the parameter to the current date and time...');\n\t\tdate = new Date();\n\t}\n\n\t// See https://stackoverflow.com/questions/10073699/pad-a-number-with-leading-zeros-in-javascript\n\t// ('000' + num).slice(-4)\n\t// return `${date.getFullYear()}-${('0' + (date.getMonth() + 1)).slice(-2)}-${('0' + date.getDate()).slice(-2)} ${('0' + date.getHours()).slice(-2)}:${('0' + date.getMinutes()).slice(-2)}:${('0' + date.getSeconds()).slice(-2)}`;\n\treturn `${date.getFullYear()}-${zeroPadNumber(date.getMonth() + 1, 2)}-${zeroPadNumber(date.getDate(), 2)} ${zeroPadNumber(date.getHours(), 2)}:${zeroPadNumber(date.getMinutes(), 2)}:${zeroPadNumber(date.getSeconds(), 2)}`;\n}\n\n// **** Array Utilities ****\n\nexport function insertNumberIntoArray (n, array) {\n\t// array must already be sorted in non-descending order.\n\tlet i = array.findIndex(m => m >= n);\n\n\tif (i < 0) {\n\t\ti = array.length;\n\t}\n\n\tlet result = clone(array);\n\n\t// Array.splice modifies the array in place. See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice\n\tresult.splice(i, 0, n);\n\n\treturn result;\n}\n\nexport function insertionSort (array) {\n\treturn array.reduce(\n\t\t(accumulator, n) => insertNumberIntoArray(n, accumulator),\n\t\t[]\n\t);\n}\n\nexport function removeDuplicatesFromArray (array) {\n\t// See the discussion at https://gist.github.com/telekosmos/3b62a31a5c43f40849bb\n\n\t// JavaScript Set: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set\n\n\t// See https://stackoverflow.com/questions/13486479/how-to-get-an-array-of-unique-values-from-an-array-containing-duplicates-in-java\n\t// Discussion about performace: See https://medium.com/@jakubsynowiec/unique-array-values-in-javascript-7c932682766c\n\t// return [...new Set(array)]; // Yes. Requires ES6, since it uses the \"spread\" operator (\"...\").\n\n\t// return Array.from(new Set(array)); // Yes\n\n\t// array.includes() does not exist.\n\n\treturn array.reduce((x, y) => x.includes(y) ? x : [...x, y], []); // Yes. From svnpenn.\n}\n\nexport function safeJsonParse (str, dflt = undefined) {\n\ttry {\n\t\treturn JSON.parse(str);\n\t} catch (e) {\n\n\t\tif (!isDefined(dflt)) {\n\t\t\tthrow e;\n\t\t}\n\n\t\treturn dflt;\n\t}\n}\n\n// avoidwork/haro/src/utility.js\n/*\n\tfunction has (a, b) {\n\t\treturn b in a;\n\t}\n\n\tfunction each (arr, fn) {\n\t\tfor (const item of arr.entries()) {\n\t\t\tfn(item[1], item[0]);\n\t\t}\n\n\t\treturn arr;\n\t}\n\n\tfunction cast (input) {\n\t\tlet result;\n\n\t\tswitch (true) {\n\t\t\tcase input instanceof Map:\n\t\t\t\tresult = {};\n\t\t\t\tinput.forEach((value, key) => {\n\t\t\t\t\tresult[key] = cast(value);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase input instanceof Set:\n\t\t\t\tresult = Array.from(input);\n\t\t\t\tbreak;\n\t\t\tcase Array.isArray(input):\n\t\t\t\tresult = new Set(input);\n\t\t\t\tbreak;\n\t\t\tcase input instanceof Object:\n\t\t\t\tresult = new Map(Object.keys(input).map(i => [i, cast(input[i])]));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tresult = input;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tfunction blob (arg) {\n\t\treturn new Blob([arg], {type: \"application/javascript\"});\n\t}\n\n\tfunction clone (arg) {\n\t\treturn JSON.parse(JSON.stringify(arg, null, 0));\n\t}\n\n\tfunction concatURI (left, right) {\n\t\treturn left.replace(regex.querystring, \"\").replace(regex.endslash, \"\") + (right ? \"/\" + right : \"\");\n\t}\n\n\tfunction keyIndex (key, data, delimiter, pattern) {\n\t\tlet result;\n\n\t\tif (key.indexOf(delimiter) > -1) {\n\t\t\tresult = key.split(delimiter).sort((a, b) => a.localeCompare(b)).map(i => data[i].toString().replace(new RegExp(pattern, \"g\"), \"\").toLowerCase()).join(delimiter);\n\t\t} else {\n\t\t\tresult = data[key];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tfunction delIndex (index, indexes, delimiter, key, data, pattern) {\n\t\tindex.forEach(i => {\n\t\t\tconst idx = indexes.get(i),\n\t\t\t\tvalue = keyIndex(i, data, delimiter, pattern);\n\n\t\t\tif (idx.has(value)) {\n\t\t\t\tconst o = idx.get(value);\n\n\t\t\t\to.delete(key);\n\n\t\t\t\tif (o.size === 0) {\n\t\t\t\t\tidx.delete(value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction createIndexes (records, indexes, key, delimiter, pattern) {\n\t\tconst result = {};\n\n\t\teach(indexes, i => {\n\t\t\tresult[i] = {};\n\t\t});\n\n\t\teach(records, i => {\n\t\t\tconst lkey = i[key];\n\n\t\t\tif (lkey !== void 0) {\n\t\t\t\tindexes.forEach(index => {\n\t\t\t\t\tconst lindex = keyIndex(index, i, delimiter, pattern);\n\n\t\t\t\t\tif (!has(result[index], lindex)) {\n\t\t\t\t\t\tresult[index][lindex] = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tresult[index][lindex].push(lkey);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tfunction iterate (obj, fn) {\n\t\tif (obj instanceof Object) {\n\t\t\teach(Object.keys(obj), i => fn.call(obj, obj[i], i));\n\t\t} else {\n\t\t\teach(obj, fn);\n\t\t}\n\t}\n\n\tfunction merge (a, b) {\n\t\tif (a instanceof Object && b instanceof Object) {\n\t\t\teach(Object.keys(b), i => {\n\t\t\t\tif (a[i] instanceof Object && b[i] instanceof Object) {\n\t\t\t\t\ta[i] = merge(a[i], b[i]);\n\t\t\t\t} else if (Array.isArray(a[i]) && Array.isArray(b[i])) {\n\t\t\t\t\ta[i] = a[i].concat(b[i]);\n\t\t\t\t} else {\n\t\t\t\t\ta[i] = b[i];\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (Array.isArray(a) && Array.isArray(b)) {\n\t\t\ta = a.concat(b);\n\t\t} else {\n\t\t\ta = b;\n\t\t}\n\n\t\treturn a;\n\t}\n\n\tfunction joinData (id, a, b, key, on, type = \"inner\") {\n\t\tconst result = [];\n\t\tlet errorMsg = \"More than one record found on \";\n\n\t\tlet error = false;\n\n\t\tfunction join (left, right, ids, include = false, reverse = false) {\n\t\t\tconst keys = Object.keys(right[0]),\n\t\t\t\tfn = !reverse ? (x, i) => x[on] === i[key] : (x, i) => x[key] === i[on];\n\n\t\t\teach(left, i => {\n\t\t\t\tconst comp = {},\n\t\t\t\t\tc = right.filter(x => fn(x, i));\n\n\t\t\t\tlet valid = true;\n\n\t\t\t\tif (c.length > 1) {\n\t\t\t\t\terror = true;\n\t\t\t\t\terrorMsg += i[on];\n\t\t\t\t\tvalid = false;\n\t\t\t\t} else if (c.length === 1) {\n\t\t\t\t\teach([i, c[0]], (x, idx) => iterate(x, (v, k) => {\n\t\t\t\t\t\tcomp[ids[idx] + \"_\" + k] = v;\n\t\t\t\t\t}));\n\t\t\t\t} else if (include) {\n\t\t\t\t\titerate(i, (v, k) => {\n\t\t\t\t\t\tcomp[ids[0] + \"_\" + k] = v;\n\t\t\t\t\t});\n\n\t\t\t\t\teach(keys, k => {\n\t\t\t\t\t\tcomp[ids[1] + \"_\" + k] = null;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (valid && Object.keys(comp).length > 0) {\n\t\t\t\t\tresult.push(comp);\n\t\t\t\t}\n\n\t\t\t\treturn valid;\n\t\t\t}, true);\n\t\t}\n\n\t\tif (type === \"inner\") {\n\t\t\tjoin(a, b, id);\n\t\t}\n\n\t\tif (type === \"left\") {\n\t\t\tjoin(a, b, id, true);\n\t\t}\n\n\t\tif (type === \"right\") {\n\t\t\tjoin(b, a, clone(id).reverse(), true, true);\n\t\t}\n\n\t\treturn !error ? result : errorMsg;\n\t}\n\n\tfunction onmessage (ev) {\n\t\tconst data = JSON.parse(ev.data),\n\t\t\tcmd = data.cmd;\n\n\t\tlet result;\n\n\t\tif (cmd === \"index\") {\n\t\t\tresult = createIndexes(data.records, data.index, data.key, data.delimiter, data.pattern);\n\t\t}\n\n\t\tif (cmd === \"join\") {\n\t\t\tresult = joinData(data.ids, data.records[0], data.records[1], data.key, data.on, data.type);\n\t\t}\n\n\t\tpostMessage(JSON.stringify(result));\n\t}\n\n\tfunction createPatch (ogdata = {}, data = {}, key = \"\", overwrite = false) {\n\t\tconst result = [];\n\n\t\tif (overwrite) {\n\t\t\titerate(ogdata, (v, k) => {\n\t\t\t\tif (k !== key && data[k] === void 0) {\n\t\t\t\t\tresult.push({op: \"remove\", path: \"/\" + k});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\titerate(data, (v, k) => {\n\t\t\tif (k !== key && ogdata[k] === void 0) {\n\t\t\t\tresult.push({op: \"add\", path: \"/\" + k, value: v});\n\t\t\t} else if (JSON.stringify(ogdata[k]) !== JSON.stringify(v)) {\n\t\t\t\tresult.push({op: \"replace\", path: \"/\" + k, value: v});\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tfunction s () {\n\t\treturn ((Math.random() + 1) * 0x10000 | 0).toString(16).substring(1);\n\t}\n\n\tfunction setIndex (index, indexes, delimiter, key, data, indice, pattern) {\n\t\teach(!indice ? index : [indice], i => {\n\t\t\tconst lidx = keyIndex(i, data, delimiter, pattern);\n\t\t\tlet lindex;\n\n\t\t\tif (lidx !== void 0 && lidx !== null) {\n\t\t\t\tlindex = indexes.get(i);\n\n\t\t\t\tif (!lindex.has(lidx)) {\n\t\t\t\t\tlindex.set(lidx, new Set());\n\t\t\t\t}\n\n\t\t\t\tlindex.get(lidx).add(key);\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction toObjekt (arg, frozen = true) {\n\t\tconst result = {};\n\n\t\targ.forEach((value, key) => {\n\t\t\tconst obj = value;\n\n\t\t\tif (frozen) {\n\t\t\t\tObject.freeze(obj);\n\t\t\t}\n\n\t\t\tresult[clone(key)] = obj;\n\t\t});\n\n\t\tif (frozen) {\n\t\t\tObject.freeze(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tfunction uuid () {\n\t\treturn s() + s() + \"-\" + s() + \"-4\" + s().substr(0, 3) + \"-\" + r[Math.floor(Math.random() * 4)] + s().substr(0, 3) + \"-\" + s() + s() + s();\n\t}\n\n\tconst functions = [\n\t\tcast.toString(),\n\t\tclone.toString(),\n\t\tcreateIndexes.toString(),\n\t\teach.toString(),\n\t\thas.toString(),\n\t\titerate.toString(),\n\t\tjoinData.toString(),\n\t\tkeyIndex.toString(),\n\t\tsetIndex.toString(),\n\t\t(node === false ? \"\" : \"self.\") + \"onmessage = \" + onmessage.toString() + \";\"\n\t].join(\"\\n\");\n*/\n\n// uuid() :\n// See https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n// See https://developer.mozilla.org/en-US/docs/Web/API/Crypto\n\n// **** BEGIN : From avoidwork/haro ****\n\n/*\nfunction s () {\n\treturn ((Math.random() + 1) * 0x10000 | 0).toString(16).substring(1);\n}\n*/\n\nexport function uuid () {\n\t// From avoidwork/haro. Thank you, Jason Mulligan.\n\tconst r = [8, 9, 'a', 'b'];\n\tconst s = () => ((Math.random() + 1) * 0x10000 | 0).toString(16).substring(1);\n\n\treturn s() + s() + '-' + s() + '-4' + s().substr(0, 3) + '-' +\n\t\tr[Math.floor(Math.random() * 4)] + s().substr(0, 3) + '-' +\n\t\ts() + s() + s();\n}\n\n// **** END : From avoidwork/haro ****\n\n// TODO: common-utilities: Create mean(), median(), mode(), histogram()\n\nexport function isArray (arg) {\n\treturn getTypeString(arg) === '[object Array]';\n}\n\n/*\nfunction factory_fnIsType (typeName) {\n\treturn arg => getTypeString(arg) === `[object ${typeName}]`;\n}\n\n// TODO: npm i -D @babel/preset-env\n// TODO: Babel presets in Gruntfile: \"presets\": [ \"@babel/preset-env\" ]\n// See https://github.com/babel/babel/issues/8575\n// See https://github.com/storybooks/storybook/issues/3937\n// See https://stackoverflow.com/questions/52092739/upgrade-to-babel-7-cannot-read-property-bindings-of-null\nexport const isArray = factory_fnIsType('Array');\n\n// export isArray;\n*/\n\nexport function isArrayOfNumbers (arg) {\n\treturn isArray(arg) &&\n\t\targ.every(element => getTypeString(element) === '[object Number]');\n}\n\nexport function isFunction (arg) {\n\treturn getTypeString(arg) === '[object Function]';\n}\n\nexport function sum (arg) {\n\n\tif (!isArrayOfNumbers(arg)) {\n\t\treturn undefined;\n\t}\n\n\treturn arg.reduce(\n\t\t(accumulator, n) => accumulator + n,\n\t\t0\n\t);\n}\n\nexport function mean (arg) {\n\n\tif (!isArrayOfNumbers(arg) || arg.length <= 0) {\n\t\treturn undefined;\n\t}\n\n\treturn sum(arg) / arg.length;\n}\n\nexport function median (arg) {\n\t// console.log('median: arg is', arg);\n\t// console.log('median: getTypeString(arg) is', getTypeString(arg));\n\n\tif (!isArrayOfNumbers(arg) || arg.length <= 0) {\n\t\treturn undefined;\n\t}\n\n\tconst sortedArray = clone(arg).sort(); // Array.sort() sorts the array *in place*\n\n\t// console.log('median: sortedArray is', sortedArray);\n\t// console.log('median: sortedArray.length is', sortedArray.length);\n\n\treturn sortedArray[Math.floor(sortedArray.length / 2)];\n}\n\nexport function histogram (arg) {\n\n\tif (!isArray(arg)) {\n\t\treturn undefined;\n\t}\n\n\tlet result = {};\n\n\targ.forEach(element => {\n\t\tresult[element] = (result[element] || 0) + 1;\n\t});\n\n\treturn result;\n\n\t/* Or:\n\treturn arg.reduce(\n\t\t(accumulator, element) => {\n\t\t\taccumulator[element] = (accumulator[element] || 0) + 1;\n\n\t\t\treturn accumulator;\n\t\t},\n\t\t{}\n\t);\n\t*/\n}\n\nexport function mode (arg) {\n\tconst hist = histogram(arg);\n\n\treturn Object.keys(hist).reduce(\n\t\t(accumulator, element) => {\n\t\t\t// console.log('mode: accumulator is', accumulator);\n\t\t\t// console.log('mode: element is', element);\n\t\t\t// console.log('mode: hist[element] is', hist[element]);\n\n\t\t\tif (hist[element] > accumulator.count) {\n\t\t\t\taccumulator = { element: element, count: hist[element] };\n\t\t\t\t// console.log('**** mode: accumulator is now', accumulator);\n\t\t\t}\n\n\t\t\treturn accumulator;\n\t\t},\n\t\t{ element: undefined, count: 0 }\n\t);\n}\n\nfunction getAllSubsetsHelper (result, arg, i, subsetInProgress) {\n\n\tif (i >= arg.length) {\n\t\tresult.push(clone(subsetInProgress));\n\t} else {\n\t\tgetAllSubsetsHelper(result, arg, i + 1, subsetInProgress);\n\t\tsubsetInProgress.push(arg[i]);\n\t\tgetAllSubsetsHelper(result, arg, i + 1, subsetInProgress);\n\t\tsubsetInProgress.pop();\n\t}\n}\n\nexport function getAllSubsets (arg, sortSubsets, fnSubsetComparator) {\n\tlet result = [];\n\n\tgetAllSubsetsHelper(result, arg, 0, []);\n\n\t// console.log('getAllSubsets() : arg is', arg, '; result is', result);\n\n\tif (sortSubsets) {\n\t\tconst fnDefaultSubsetComparator = (s1, s2) => {\n\t\t\tconst lengthDiff = s1.length - s2.length;\n\n\t\t\tif (lengthDiff) {\n\t\t\t\treturn lengthDiff;\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < s1.length; ++i) {\n\t\t\t\tconst elementDiff = s1[i] - s2[i];\n\n\t\t\t\tif (elementDiff) {\n\t\t\t\t\treturn elementDiff;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t};\n\n\t\tresult.sort(fnSubsetComparator || fnDefaultSubsetComparator);\n\t}\n\n\treturn result;\n}\n\nfunction isSubset (set1, set2, fnElementsAreEqual) {\n\treturn set1.every(element1 => isDefined(set2.find(element2 => fnElementsAreEqual(element1, element2))));\n}\n\nexport function areSetsEqual (set1, set2, fnElementsAreEqual) {\n\n\tif (!isFunction(fnElementsAreEqual)) {\n\t\tfnElementsAreEqual = (a, b) => a === b;\n\t}\n\n\treturn isArray(set1) && isArray(set2) && isSubset(set1, set2, fnElementsAreEqual) && isSubset(set2, set1, fnElementsAreEqual);\n}\n"]}